# Windows 11 Compatibility Check Script

Clear-Host
Write-Host "--- Windows 11 Compatibility Check ---`n"

# Helper for output
function Write-CheckResult {
    param (
        [string]$Check,
        [bool]$Success,
        [string]$Message
    )
    $Green = "`e[32m"
    $Red = "`e[31m"
    $Reset = "`e[0m"
    $Result = if ($Success) { "$Green" + "PASS" + "$Reset" } else { "$Red" + "FAIL" + "$Reset" }
    Write-Host ("{0,-20} {1,-6} {2}" -f $Check, $Result, $Message)
}

# 1. CPU Architecture
$arch = (Get-CimInstance -ClassName Win32_Processor).AddressWidth
Write-CheckResult "Architecture" ($arch -eq 64) "System is $arch-bit"

# 2. RAM
$ram = (Get-CimInstance -ClassName Win32_ComputerSystem).TotalPhysicalMemory
$ramGB = [math]::Round($ram / 1GB)
Write-CheckResult "RAM" ($ramGB -ge 4) "$ramGB GB Installed"

# 3. Storage
$systemDrive = Get-PSDrive C
$systemDriveFreeGB = [math]::Round($systemDrive.Free / 1GB)
Write-CheckResult "Storage (C:)" ($systemDriveFreeGB -ge 64) "$systemDriveFreeGB GB free"

# 4. UEFI (Firmware)
$isUEFI = $false
try {
    $fwType = (Get-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control" -Name "PEFirmwareType" -ErrorAction Stop).PEFirmwareType
    if ($fwType -eq 2) { $isUEFI = $true }
} catch {
    if ($env:firmware_type -eq "UEFI") { $isUEFI = $true }
}
$uefiMsg = if ($isUEFI) {"UEFI"} else {"Legacy BIOS"}
Write-CheckResult "UEFI Firmware" $isUEFI $uefiMsg

# 5. Secure Boot
$isSecureBoot = $false
try {
    if (Confirm-SecureBootUEFI) { $isSecureBoot = $true }
} catch {}
$secureBootMsg = if ($isSecureBoot) {"Enabled"} else {"Disabled/Not Available"}
Write-CheckResult "Secure Boot" $isSecureBoot $secureBootMsg

# 6. TPM (Trusted Platform Module)
$TPMSpec = (Get-CimInstance -Namespace "Root/CIMV2/Security/MicrosoftTpm" -ClassName Win32_Tpm | Select-Object -First 1).SpecVersion -split ',' | Select-Object -First 1
if ([string]::IsNullOrEmpty($TPMSpec)) {
    Write-CheckResult "TPM Version" $false "TPM is not installed in computer"
} else {
    $Version = [version]$TPMSpec
    $tpmCompliant = $Version -ge [version]'2.0'
    $msg = if ($tpmCompliant) { "TPM $Version (Win11 compliant)" } else { "TPM $Version (not Win11 compliant)" }
    Write-CheckResult "TPM Version" $tpmCompliant $msg
}

# 7. CPU
$cpu = Get-CimInstance -ClassName Win32_Processor
$cpuCores = $cpu.NumberOfCores
$cpuSpeed = [math]::Round($cpu.MaxClockSpeed / 1000, 2)
Write-CheckResult "CPU Cores" ($cpuCores -ge 2) "$cpuCores Cores"
Write-CheckResult "CPU Speed" ($cpuSpeed -ge 1.0) "$cpuSpeed GHz"

# 8. CPU Model Compatibility
$cpuName = $cpu.Name.Trim()
# Source of Intel CPUs: https://learn.microsoft.com/en-us/windows-hardware/design/minimum/supported/windows-11-supported-intel-processors
$intelList = @(
    "x6200FE",
    "x6211E",
    "x6212RE",
    "x6413E",
    "x6414RE",
    "x6425E",
    "x6425RE",
    "x6427FE",
    "6305",
    "7300",
    "7305",
    "3867U",
    "4205U",
    "4305U",
    "4305UE",
    "5205U",
    "5305U",
    "6305E",
    "6600HE",
    "7305E",
    "7305L",
    "G4900",
    "G4900T",
    "G4920",
    "G4930",
    "G4930E",
    "G4930T",
    "G4932E",
    "G4950",
    "G5900",
    "G5900E",
    "G5900T",
    "G5900TE",
    "G5905",
    "G5905T",
    "G5920",
    "G5925",
    "G6900",
    "G6900E",
    "G6900T",
    "G6900TE",
    "J4005",
    "J4025",
    "J4105",
    "J4115",
    "J4125",
    "J6412",
    "J6413",
    "N4000",
    "N4020",
    "N4100",
    "N4120",
    "N4500",
    "N4505",
    "N5100",
    "N5105",
    "N6210",
    "N6211",
    "3-100U",
    "3-100U with IPU",
    "5-120U",
    "7-150U",
    "i3-1000G1",
    "i3-1000G4",
    "i3-1005G1",
    "i3-10100",
    "i3-10100E",
    "i3-10100F",
    "i3-10100T",
    "i3-10100TE",
    "i3-10100Y",
    "i3-10105",
    "i3-10105F",
    "i3-10105T",
    "i3-10110U",
    "i3-10110Y",
    "i3-10300",
    "i3-10300T",
    "i3-10305",
    "i3-10305T",
    "i3-10320",
    "i3-10325",
    "i3-11100HE",
    "i3-1110G4",
    "i3-1115G4",
    "i3-1115G4E",
    "i3-1115GRE",
    "i3-1120G4",
    "i3-1125G4",
    "i3-12100",
    "i3-12100E",
    "i3-12100F",
    "i3-12100T",
    "i3-12100TE",
    "i3-1210U",
    "i3-1215U",
    "i3-1215UE",
    "i3-1215UL",
    "i3-1220P",
    "i3-1220PE",
    "i3-12300",
    "i3-12300HE",
    "i3-12300HL",
    "i3-12300T",
    "i3-1305U",
    "i3-13100",
    "i3-13100E",
    "i3-13100F",
    "i3-13100T",
    "i3-13100TE",
    "i3-1315U",
    "i3-1315UE",
    "i3-1320PE",
    "i3-13300HE",
    "i3-14100",
    "i3-14100F",
    "i3-14100T",
    "i3-8100",
    "i3-8100B",
    "i3-8100H",
    "i3-8100T",
    "i3-8109U",
    "i3-8130U",
    "i3-8140U",
    "i3-8145U",
    "i3-8145UE",
    "i3-8300",
    "i3-8300T",
    "i3-8350K",
    "i3-9100",
    "i3-9100E",
    "i3-9100F",
    "i3-9100HL",
    "i3-9100T",
    "i3-9100TE",
    "i3-9300",
    "i3-9300T",
    "i3-9320",
    "i3-9350K",
    "i3-9350KF",
    "i3-N300",
    "i3-N305",
    "i5-10200H",
    "i5-10210U",
    "i5-10210Y",
    "i5-10300H",
    "i5-1030G4",
    "i5-1030G7",
    "i5-10310U",
    "i5-10310Y",
    "i5-1035G1",
    "i5-1035G4",
    "i5-1035G7",
    "i5-1038NG7",
    "i5-10400",
    "i5-10400F",
    "i5-10400H",
    "i5-10400T",
    "i5-10500",
    "i5-10500E",
    "i5-10500H",
    "i5-10500T",
    "i5-10500TE",
    "i5-10505",
    "i5-10600",
    "i5-10600K",
    "i5-10600KF",
    "i5-10600T",
    "i5-11260H",
    "i5-11300H",
    "i5-1130G7",
    "i5-11320H",
    "i5-1135G7",
    "i5-11400",
    "i5-11400F",
    "i5-11400H",
    "i5-11400T",
    "i5-1140G7",
    "i5-1145G7",
    "i5-1145G7E",
    "i5-1145GRE",
    "i5-11500",
    "i5-11500H",
    "i5-11500HE",
    "i5-11500T",
    "i5-1155G7",
    "i5-11600",
    "i5-11600K",
    "i5-11600KF",
    "i5-11600T",
    "i5-1230U",
    "i5-1235U",
    "i5-1235UL",
    "i5-12400",
    "i5-12400F",
    "i5-12400T",
    "i5-1240P",
    "i5-1240U",
    "i5-12450H",
    "i5-12450HX",
    "i5-1245U",
    "i5-1245UE",
    "i5-1245UL",
    "i5-12500",
    "i5-12500E",
    "i5-12500H",
    "i5-12500HL",
    "i5-12500T",
    "i5-12500TE",
    "i5-1250P",
    "i5-1250PE",
    "i5-12600",
    "i5-12600H",
    "i5-12600HE",
    "i5-12600HL",
    "i5-12600HX",
    "i5-12600K",
    "i5-12600KF",
    "i5-12600T",
    "i5-1334U",
    "i5-1335U",
    "i5-1335UE",
    "i5-13400",
    "i5-13400E",
    "i5-13400F",
    "i5-13400T",
    "i5-1340P",
    "i5-1340PE",
    "i5-13420H",
    "i5-13450HX",
    "i5-1345U",
    "i5-1345UE",
    "i5-13490F",
    "i5-13500",
    "i5-13500E",
    "i5-13500H",
    "i5-13500HX",
    "i5-13500T",
    "i5-13500TE",
    "i5-13505H",
    "i5-1350P",
    "i5-1350PE",
    "i5-13600",
    "i5-13600H",
    "i5-13600HE",
    "i5-13600HX",
    "i5-13600K",
    "i5-13600KF",
    "i5-13600T",
    "i5-14400",
    "i5-14400F",
    "i5-14400T",
    "i5-14500",
    "i5-14500T",
    "i5-14600",
    "i5-14600K",
    "i5-14600KF",
    "i5-14600T",
    "i5-8200Y",
    "i5-8210Y",
    "i5-8250U",
    "i5-8257U",
    "i5-8259U",
    "i5-8260U",
    "i5-8265U",
    "i5-8269U",
    "i5-8279U",
    "i5-8300H",
    "i5-8305G",
    "i5-8310Y",
    "i5-8350U",
    "i5-8365U",
    "i5-8365UE",
    "i5-8400",
    "i5-8400B",
    "i5-8400H",
    "i5-8400T",
    "i5-8500",
    "i5-8500B",
    "i5-8500T",
    "i5-8600",
    "i5-8600K",
    "i5-8600T",
    "i5-9300H",
    "i5-9300HF",
    "i5-9400",
    "i5-9400F",
    "i5-9400H",
    "i5-9400T",
    "i5-9500",
    "i5-9500E",
    "i5-9500F",
    "i5-9500T",
    "i5-9500TE",
    "i5-9600",
    "i5-9600K",
    "i5-9600KF",
    "i5-9600T",
    "i7-10510U",
    "i7-10510Y",
    "i7-1060G7",
    "i7-10610U",
    "i7-1065G7",
    "i7-1068G7",
    "i7-1068NG7",
    "i7-10700",
    "i7-10700E",
    "i7-10700F",
    "i7-10700K",
    "i7-10700KF",
    "i7-10700T",
    "i7-10700TE",
    "i7-10710U",
    "i7-10750H",
    "i7-10810U",
    "i7-10850H",
    "i7-10870H",
    "i7-10875H",
    "i7-11370H",
    "i7-11375H",
    "i7-11390H",
    "i7-11600H",
    "i7-1160G7",
    "i7-1165G7",
    "i7-11700",
    "i7-11700F",
    "i7-11700K",
    "i7-11700KF",
    "i7-11700T",
    "i7-11800H",
    "i7-1180G7",
    "i7-11850H",
    "i7-11850HE",
    "i7-1185G7",
    "i7-1185G7E",
    "i7-1185GRE",
    "i7-1195G7",
    "i7-1250U",
    "i7-1255U",
    "i7-1255UL",
    "i7-1260P",
    "i7-1260U",
    "i7-12650H",
    "i7-12650HX",
    "i7-1265U",
    "i7-1265UE",
    "i7-1265UL",
    "i7-12700",
    "i7-12700E",
    "i7-12700F",
    "i7-12700H",
    "i7-12700HL",
    "i7-12700K",
    "i7-12700KF",
    "i7-12700T",
    "i7-12700TE",
    "i7-1270P",
    "i7-1270PE",
    "i7-12800H",
    "i7-12800HE",
    "i7-12800HL",
    "i7-12800HX",
    "i7-1280P",
    "i7-12850HX",
    "i7-1355U",
    "i7-1360P",
    "i7-13620H",
    "i7-13650HX",
    "i7-1365U",
    "i7-1365UE",
    "i7-13700",
    "i7-13700E",
    "i7-13700F",
    "i7-13700H",
    "i7-13700HX",
    "i7-13700K",
    "i7-13700KF",
    "i7-13700T",
    "i7-13700TE",
    "i7-13705H",
    "i7-1370P",
    "i7-1370PE",
    "i7-13790F",
    "i7-13800H",
    "i7-13800HE",
    "i7-13850HX",
    "i7-14700",
    "i7-14700F",
    "i7-14700K",
    "i7-14700KF",
    "i7-14700T",
    "i7-7800X",
    "i7-7820HQ",
    "i7-7820X",
    "i7-8086K",
    "i7-8500Y",
    "i7-8550U",
    "i7-8557U",
    "i7-8559U",
    "i7-8565U",
    "i7-8569U",
    "i7-8650U",
    "i7-8665U",
    "i7-8665UE",
    "i7-8700",
    "i7-8700B",
    "i7-8700K",
    "i7-8700T",
    "i7-8705G",
    "i7-8706G",
    "i7-8709G",
    "i7-8750H",
    "i7-8809G",
    "i7-8850H",
    "i7-9700",
    "i7-9700E",
    "i7-9700F",
    "i7-9700K",
    "i7-9700KF",
    "i7-9700T",
    "i7-9700TE",
    "i7-9750H",
    "i7-9750HF",
    "i7-9800X",
    "i7-9850H",
    "i7-9850HE",
    "i7-9850HL",
    "i9-10850K",
    "i9-10885H",
    "i9-10900",
    "i9-10900E",
    "i9-10900F",
    "i9-10900K",
    "i9-10900KF",
    "i9-10900T",
    "i9-10900TE",
    "i9-10900X",
    "i9-10920X",
    "i9-10940X",
    "i9-10980HK",
    "i9-10980XE",
    "i9-11900",
    "i9-11900F",
    "i9-11900H",
    "i9-11900K",
    "i9-11900KF",
    "i9-11900T",
    "i9-11950H",
    "i9-11980HK",
    "i9-12900",
    "i9-12900E",
    "i9-12900F",
    "i9-12900H",
    "i9-12900HK",
    "i9-12900HX",
    "i9-12900K",
    "i9-12900KF",
    "i9-12900KS",
    "i9-12900T",
    "i9-12900TE",
    "i9-12950HX",
    "i9-13900",
    "i9-13900E",
    "i9-13900F",
    "i9-13900H",
    "i9-13900HK",
    "i9-13900HX",
    "i9-13900K",
    "i9-13900KF",
    "i9-13900KS",
    "i9-13900T",
    "i9-13900TE",
    "i9-13905H",
    "i9-13950HX",
    "i9-13980HX",
    "i9-14900",
    "i9-14900F",
    "i9-14900K",
    "i9-14900KF",
    "i9-14900T",
    "i9-7900X",
    "i9-7920X",
    "i9-7940X",
    "i9-7960X",
    "i9-7980XE",
    "i9-8950HK",
    "i9-9820X",
    "i9-9880H",
    "i9-9900",
    "i9-9900K",
    "i9-9900KF",
    "i9-9900KS",
    "i9-9900T",
    "i9-9900X",
    "i9-9920X",
    "i9-9940X",
    "i9-9960X",
    "i9-9980HK",
    "i9-9980XE",
    "m3-8100Y",
    "Ultra 5-125H",
    "Ultra 5-125U",
    "Ultra 5-134U",
    "Ultra 5-135H",
    "Ultra 5-135U",
    "Ultra 7-155H",
    "Ultra 7-155U",
    "Ultra 7-164U",
    "Ultra 7-165H",
    "Ultra 7-165U",
    "Ultra 9-185H",
    "Gold 4417U",
    "Gold 4425Y",
    "Gold 5405U",
    "Gold 6405U",
    "Gold 6500Y",
    "Gold 6805",
    "Gold 7505",
    "Gold 8500",
    "Gold 8505",
    "Gold G5400",
    "Gold G5400T",
    "Gold G5420",
    "Gold G5420T",
    "Gold G5500",
    "Gold G5500T",
    "Gold G5600",
    "Gold G5600E",
    "Gold G5600T",
    "Gold G5620",
    "Gold G6400",
    "Gold G6400E",
    "Gold G6400T",
    "Gold G6400TE",
    "Gold G6405",
    "Gold G6405T",
    "Gold G6500",
    "Gold G6500T",
    "Gold G6505",
    "Gold G6505T",
    "Gold G6600",
    "Gold G6605",
    "Gold G7400",
    "Gold G7400E",
    "Gold G7400T",
    "Gold G7400TE",
    "J6426",
    "N6415",
    "Silver J5005",
    "Silver J5040",
    "Silver N5000",
    "Silver N5030",
    "Silver N6000",
    "Silver N6005",
    "N100",
    "N200",
    "N50",
    "N95",
    "N97",
    "U300",
    "U300E"
)
# Source of AMD CPUs: https://learn.microsoft.com/en-us/windows-hardware/design/minimum/supported/windows-11-supported-amd-processors
$amdList = @(
    "3015e",
    "3020e",
    "3000G",
    "300GE",
    "300U",
    "320GE",
    "7120e",
    "7120U",
    "7220e",
    "7220U",
    "Gold 3150C",
    "Gold 3150G",
    "Gold 3150GE",
    "Gold 3150U",
    "Silver 3050C",
    "Silver 3050e",
    "Silver 3050GE",
    "Silver 3050U",
    "Gold PRO 3125GE",
    "Gold PRO 3150G",
    "Gold PRO 3150GE",
    "Gold PRO 4150GE",
    "PRO 300GE",
    "PRO 300U",
    "PRO 3045B",
    "7252",
    "7262",
    "7272",
    "7282",
    "7302",
    "7313",
    "7343",
    "7352",
    "7402",
    "7413",
    "7443",
    "7452",
    "7453",
    "7502",
    "7513",
    "7532",
    "7542",
    "7543",
    "7552",
    "7642",
    "7643",
    "7662",
    "7663",
    "7702",
    "7713",
    "7742",
    "7763",
    "7232P",
    "72F3",
    "7302P",
    "7313P",
    "73F3",
    "7402P",
    "7443P",
    "74F3",
    "7502P",
    "7543P",
    "75F3",
    "7702P",
    "7713P",
    "7F32",
    "7F52",
    "7F72",
    "7H12",
    "R2312",
    "R2314",
    "R2514",
    "R2544",
    "Z1",
    "Z1 Extreme",
    "3100",
    "4100",
    "2300X",
    "3200G with Radeon Vega 8 Graphics",
    "3200GE",
    "3200U",
    "3250C",
    "3250U",
    "3300U",
    "3350U",
    "4300G",
    "4300GE",
    "4300U",
    "5125C",
    "5300G (OEM Only)",
    "5300GE",
    "5300GE (OEM Only)",
    "5300U",
    "5400U",
    "5425C",
    "5425U",
    "7320e",
    "7320U",
    "7330U",
    "7335U",
    "7440U",
    "5380U",
    "PRO 3200G",
    "PRO 3200GE",
    "PRO 3300U",
    "PRO 4350G",
    "PRO 4350GE",
    "PRO 4450U",
    "PRO 5350G",
    "PRO 5350GE",
    "PRO 5450U",
    "PRO 5475U",
    "PRO 7330U",
    "PRO 4355G",
    "PRO 4355GE",
    "2600",
    "3600",
    "4500",
    "5500",
    "5600",
    "7600",
    "2500X",
    "2600E",
    "2600X",
    "3350G",
    "3350GE",
    "3400G with Radeon RX Vega 11 Graphics",
    "3400GE",
    "3450U",
    "3500 Processor",
    "3500C",
    "3500U",
    "3500X",
    "3550H",
    "3580U Microsoft Surface Edition",
    "3600X",
    "3600XT",
    "4500U",
    "4600G",
    "4600GE",
    "4600H",
    "4600HS",
    "4600U",
    "5300G",
    "5300GE",
    "5425U",
    "5500U",
    "5560U",
    "5600G",
    "5600GE",
    "5600H",
    "5600HS",
    "5600U",
    "5600X",
    "5625C",
    "5625U",
    "6600H",
    "6600HS",
    "6600U",
    "7520U",
    "7530U",
    "7535HS",
    "7535U",
    "7540U",
    "7600X",
    "7640HS",
    "7640S",
    "7640U",
    "7645HX",
    "7640H",
    "PRO 2600",
    "PRO 3600",
    "PRO 5645",
    "PRO 3350G",
    "PRO 3350GE",
    "PRO 3400G",
    "PRO 3400GE",
    "PRO 3500U",
    "PRO 4650G",
    "PRO 4650GE",
    "PRO 4650U",
    "PRO 5475U",
    "PRO 5650G",
    "PRO 5650GE",
    "PRO 5650HS",
    "PRO 5650HX",
    "PRO 5650U",
    "PRO 5675U",
    "PRO 5750G",
    "PRO 5750GE",
    "PRO 6650H",
    "PRO 6650HS",
    "PRO 6650U",
    "PRO 7530U",
    "PRO 7540U",
    "PRO 7640U",
    "PRO 4655G",
    "PRO 4655GE",
    "2700",
    "5800",
    "7700",
    "2700E Processor",
    "2700X",
    "3700C",
    "3700U",
    "3700X",
    "3750H",
    "3780U Microsoft Surface Edition",
    "3800X",
    "3800XT",
    "4700G",
    "4700GE",
    "4700U",
    "4800H",
    "4800HS",
    "4800U",
    "5700G",
    "5700GE",
    "5700U",
    "5700X",
    "5800H",
    "5800HS",
    "5800U",
    "5800X",
    "5800X3D",
    "5825C",
    "5825U",
    "6800H",
    "6800HS",
    "6800U",
    "6810U",
    "7700X",
    "7730U",
    "7735HS",
    "7735U",
    "7736U",
    "7745HX",
    "7800X3D",
    "7840H",
    "7840HS",
    "7840S",
    "7840U",
    "PRO 2700",
    "PRO 3700",
    "PRO 5845",
    "PRO 2700X",
    "PRO 3700U",
    "PRO 4750G",
    "PRO 4750GE",
    "PRO 4750U",
    "PRO 5850HS",
    "PRO 5850HX",
    "PRO 5850U",
    "PRO 5875U",
    "PRO 6850H",
    "PRO 6850HS",
    "PRO 6850U",
    "PRO 6860Z",
    "PRO 7730U",
    "PRO 7840U",
    "5900",
    "7900",
    "3900 Processor",
    "3900X",
    "3900XT",
    "3950X",
    "4900H",
    "4900HS",
    "5900HS",
    "5900HX",
    "5900X",
    "5950X",
    "5980HS",
    "5980HX",
    "6900HS",
    "6900HX",
    "6980HS",
    "6980HX",
    "7845HX",
    "7900X",
    "7900X3D",
    "7940H",
    "7940HS",
    "7945HX",
    "7950X",
    "7950X3D",
    "PRO 3900",
    "PRO 5945",
    "PRO 6950H",
    "PRO 6950HS",
    "V2516",
    "V2546",
    "V2718",
    "V2748",
    "PRO 3945WX",
    "PRO 3955WX",
    "PRO 3975WX",
    "PRO 3995WX",
    "PRO 5945WX",
    "PRO 5955WX",
    "PRO 5965WX",
    "PRO 5975WX",
    "PRO 5995WX"
)

$isIntel = $cpu.Manufacturer -like '*Intel*'
$isAMD = $cpu.Manufacturer -like '*AMD*'
$cpuSupported = $false
function Normalize-CPUString($str) {
    return ($str -replace '[^A-Za-z0-9]', '').ToLower()
}
if ($isIntel) {
    $normCpuName = Normalize-CPUString $cpuName
    foreach ($model in $intelList) {
        $normModel = Normalize-CPUString $model
        if ($normCpuName -like "*${normModel}*") {
            $cpuSupported = $true; break
        }
    }
} elseif ($isAMD) {
    $normCpuName = Normalize-CPUString $cpuName
    foreach ($model in $amdList) {
        $normModel = Normalize-CPUString $model
        if ($normCpuName -like "*${normModel}*") {
            $cpuSupported = $true; break
        }
    }
}
Write-CheckResult "CPU Supported" $cpuSupported $cpuName


Write-Host "`n--- Finished ---`n"
